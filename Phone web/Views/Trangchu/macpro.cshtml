
@{
    ViewBag.Title = "macpro";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
}


<div class="sanpham">
    <div class="sp">
        <img src="~/hinh/pro4.jpg" class="sp-img" />
        <img src="~/hinh/pro1.jpg" class="sp-img" />
        <img src="~/hinh/pro5.jpg" class="sp-img" />
        <img src="~/hinh/pro7.jpg" class="sp-img" />
        <img src="~/hinh/pro3.jpg" class="sp-img" />
        <img src="~/hinh/pro6.jpg" class="sp-img" />

    </div><div class="sp-detail">
    <h2>MACBOOK POR</h2>
    <div>
        <b>Màu sắc:</b>
        <div id="khung-chon-mau"></div>
    </div>

    


</div>

    <div class="sp-tttt">
        <div>
            <img id="product-img" src="" alt="Sản phẩm" width="300" />

        </div>

        <div class="soluong">
            <button id="minus"><i class="fa-solid fa-minus"></i></button>
            <input id="qty" type="number" value="1" min="1" readonly />
            <button id="plus"><i class="fa-solid fa-plus"></i></button>
        </div>

        <p>Tạm tính: <span id="total"></span></p>
        <buttonclass="btn" id="add-cart">Thêm vào giỏ hàng</buttonclass="btn>



    </div>
</div>
<script>

    const product = {
        name: "MacBook Pro ",
        price: 41860000,
        mauSacList: [
            { name: "MacBook Pro- Silver", img: "hinh/pro4.jpg" },
            { name: "MacBook Pro - Black", img: "hinh/pro8.jpg" },
           
        ]
    };

    const imgMain = document.getElementById("product-img");
    const khungChonMau = document.getElementById("khung-chon-mau");
    const qtyInput = document.getElementById("qty");
    const totalSpan = document.getElementById("total");
    const btnMinus = document.getElementById("minus");
    const btnPlus = document.getElementById("plus");
    const btnAddCart = document.getElementById("add-cart");


    let mauDangChon = product.mauSacList[0];
    let qty = 1;

    function renderMauSac() {
        khungChonMau.innerHTML = "";
        product.mauSacList.forEach((mau, i) => {
            const label = document.createElement("label");
            label.className = "nhan-mau";
            label.textContent = mau.name;

            if (mau.name === mauDangChon.name) label.classList.add("active");

            label.onclick = () => {
                mauDangChon = mau;
                imgMain.src = mau.img;
                document.querySelectorAll(".nhan-mau").forEach(l => l.classList.remove("active"));
                label.classList.add("active");
            };

            khungChonMau.appendChild(label);
        });

        imgMain.src = mauDangChon.img;
    }

    function updateTotal() {
        totalSpan.textContent = (qty * product.price).toLocaleString("vi-VN") + "đ";
    }

    btnPlus.onclick = () => {
        qty++;
        qtyInput.value = qty;
        updateTotal();
    };

    btnMinus.onclick = () => {
        qty--;
        if (qty < 1) qty = 1;
        qtyInput.value = qty;
        updateTotal();
    };

    qtyInput.oninput = () => {
        qty = parseInt(qtyInput.value) || 1;
        if (qty < 1) qty = 1;
        qtyInput.value = qty;
        updateTotal();
    };

    btnAddCart.onclick = () => {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(i => i.name === mauDangChon.name);

        if (existing) {
            existing.qty += qty;
        } else {
            cart.push({
                name: mauDangChon.name,
                price: product.price,
                img: mauDangChon.img,
                qty: qty
            });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert("🐼 Sản phẩm đã được thêm vào giỏ hàng!");
    };

    // Khởi tạo giao diện
    renderMauSac();
    updateTotal();

</script>
