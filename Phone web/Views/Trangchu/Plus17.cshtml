
@{
    ViewBag.Title = "Plus17";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
}

<h2>Plus17</h2>
<div class="sanpham">
    <div class="sp">
        <img src="~/hinh/17plus.77.jpg" class="sp-img" />
        <img src="~/hinh/17plus.10.jpg" class="sp-img" />
        <img src="~/hinh/17plus.9.jpg" class="sp-img" />
        <img src="~/hinh/17plus.8.jpg" class="sp-img" />
        <img src="~/hinh/17plus.5.jpg" class="sp-img" />
        <img src="~/hinh/17plus.3.jpg" class="sp-img" />
        <img src="~/hinh/17plus.4.jpg" class="sp-img" />
    </div>
    <div class="sp-detail">
        <h2>IPHONE 17 PLUS</h2>
        <div>
            <b>Màu sắc:</b>
            <div id="khung-chon-mau"></div>
        </div>

        <div>
            <p style="margin-bottom:10px"> <b>Dung lượng:</b></p>
            <div id="khung-chon-gb"></div>
        </div>

    </div>

    <div class="sp-tttt">
        <div>
            <img id="product-img" src="" alt="Sản phẩm" width="300" />
            <div id="khung-chon-mau"></div>
        </div>

        <div class="soluong">
            <button id="minus"><i class="fa-solid fa-minus"></i></button>
            <input id="qty" type="number" value="1" min="1" readonly />
            <button id="plus"><i class="fa-solid fa-plus"></i></button>
        </div>

        <p>Tạm tính: <span id="total"></span></p>
        <button  class="btn "id="add-cart">Thêm vào giỏ hàng</button>



    </div>
</div>
<script>

    const product = {
        name: "Iphone 17 Plus",
        price: 25699000,
        mauSacList: [
            { name: "Iphone 17 Plus - Mist Blue", img: "hinh/17plus.2.jpg" },
            { name: "Iphone 17 Plus - Sage", img: "hinh/17plus.3.jpg" },
            { name: "Iphone 17 Plus - White", img: "hinh/17phus.5.jpg" },
            { name: "Iphone 17 Plus - Black", img: "hinh/17phus,4.jpg" },
            { name: "Iphone 17 Plus - Lavender", img: "hinh/17plus.9.jpg" },

        ],

        dungLuongList: [
            { name: "128GB" },
            { name: "256GB" },
            { name: "512GB" },
            { name: "1T" },
        ]
    };

    const imgMain = document.getElementById("product-img");
    const khungChonMau = document.getElementById("khung-chon-mau");
    const qtyInput = document.getElementById("qty");
    const totalSpan = document.getElementById("total");
    const btnMinus = document.getElementById("minus");
    const btnPlus = document.getElementById("plus");
    const btnAddCart = document.getElementById("add-cart");


    let mauDangChon = product.mauSacList[0];
    let qty = 1;

    function renderMauSac() {
        khungChonMau.innerHTML = "";
        product.mauSacList.forEach((mau, i) => {
            const label = document.createElement("label");
            label.className = "nhan-mau";
            label.textContent = mau.name;

            if (mau.name === mauDangChon.name) label.classList.add("active");

            label.onclick = () => {
                mauDangChon = mau;
                imgMain.src = mau.img;
                document.querySelectorAll(".nhan-mau").forEach(l => l.classList.remove("active"));
                label.classList.add("active");
            };

            khungChonMau.appendChild(label);
        });

        imgMain.src = mauDangChon.img;
    }
    const khungChonGB = document.getElementById("khung-chon-gb");
    let gbDangChon = product.dungLuongList[0]; // chọn mặc định

    function renderDungLuong() {
        khungChonGB.innerHTML = "";
        product.dungLuongList.forEach((gb) => {
            const label = document.createElement("label");
            label.className = "nhan-gb";
            label.textContent = gb.name;

            if (gb.name === gbDangChon.name) label.classList.add("active");

            label.onclick = () => {
                gbDangChon = gb;
                document.querySelectorAll(".nhan-gb").forEach(l => l.classList.remove("active"));
                label.classList.add("active");
            };

            khungChonGB.appendChild(label);
        });
    }

    function updateTotal() {
        totalSpan.textContent = (qty * product.price).toLocaleString("vi-VN") + "đ";
    }

    btnPlus.onclick = () => {
        qty++;
        qtyInput.value = qty;
        updateTotal();
    };

    btnMinus.onclick = () => {
        qty--;
        if (qty < 1) qty = 1;
        qtyInput.value = qty;
        updateTotal();
    };

    qtyInput.oninput = () => {
        qty = parseInt(qtyInput.value) || 1;
        if (qty < 1) qty = 1;
        qtyInput.value = qty;
        updateTotal();
    };

    btnAddCart.onclick = () => {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(i => i.name === mauDangChon.name);

        if (existing) {
            existing.qty += qty;
        } else {
            cart.push({
                name: mauDangChon.name,
                gb: gbDangChon.name,
                price: product.price,
                img: mauDangChon.img,
                qty: qty
            });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert("🐼 Sản phẩm đã được thêm vào giỏ hàng!");
    };

    // Khởi tạo giao diện
    renderMauSac();
    renderDungLuong();
    updateTotal();

</script>


