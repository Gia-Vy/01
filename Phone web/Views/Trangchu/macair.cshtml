
@{
    ViewBag.Title = "macair";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
}


<div class="sanpham">
    <div class="sp">
        <img src="~/hinh/mac9.jpg" class="sp-img" />
        <img src="~/hinh/mac16.jpg" class="sp-img" />
        
        <img src="~/hinh/mac15.jpg" class="sp-img" />
        <img src="~/hinh/mac.jpg" class="sp-img" />
        <img src="~/hinh/mac5.jpg" class="sp-img" />
        <img src="~/hinh/mac12.jpg" class="sp-img" />
        <img src="~/hinh/mac14.jpg" class="sp-img" />


    </div>
    <div class="sp-detail">
        <h2>MACBOOK AIR M4</h2>
        <div>
            <b>Màu sắc:</b>
            <div id="khung-chon-mau"></div>
        </div>

       
    </div>

    <div class="sp-tttt">
        <div>
            <img id="product-img" src="" alt="Sản phẩm" width="300" />
            <div id="khung-chon-mau"></div>
        </div>

        <div class="soluong">
            <button id="minus"><i class="fa-solid fa-minus"></i></button>
            <input id="qty" type="number" value="1" min="1" readonly />
            <button id="plus"><i class="fa-solid fa-plus"></i></button>
        </div>

        <p>Tạm tính: <span id="total"></span></p>
        <button class="btn"  id="add-cart">Thêm vào giỏ hàng</buttonclass="btn">



    </div>
</div>
<script>

    const product = {
        name: "MacBook Air M4",
        price: 41860000,
        mauSacList: [
            { name: "AirPods Air - Sky Blue", img: "hinh/mac15.jpg" },
            { name: "AirPods Air - MidNight", img: "hinh/mac9.jpg" },
            { name: "AirPods Air - Silver", img: "hinh/mac14.jpg" },
            { name: "AirPods Air - Startlight", img: "hinh/mac4.jpg" },
          

        ]
    };

    const imgMain = document.getElementById("product-img");
    const khungChonMau = document.getElementById("khung-chon-mau");
    const qtyInput = document.getElementById("qty");
    const totalSpan = document.getElementById("total");
    const btnMinus = document.getElementById("minus");
    const btnPlus = document.getElementById("plus");
    const btnAddCart = document.getElementById("add-cart");


    let mauDangChon = product.mauSacList[0];
    let qty = 1;

    function renderMauSac() {
        khungChonMau.innerHTML = "";
        product.mauSacList.forEach((mau, i) => {
            const label = document.createElement("label");
            label.className = "nhan-mau";
            label.textContent = mau.name;

            if (mau.name === mauDangChon.name) label.classList.add("active");

            label.onclick = () => {
                mauDangChon = mau;
                imgMain.src = mau.img;
                document.querySelectorAll(".nhan-mau").forEach(l => l.classList.remove("active"));
                label.classList.add("active");
            };

            khungChonMau.appendChild(label);
        });

        imgMain.src = mauDangChon.img;
    }

    function updateTotal() {
        totalSpan.textContent = (qty * product.price).toLocaleString("vi-VN") + "đ";
    }

    btnPlus.onclick = () => {
        qty++;
        qtyInput.value = qty;
        updateTotal();
    };

    btnMinus.onclick = () => {
        qty--;
        if (qty < 1) qty = 1;
        qtyInput.value = qty;
        updateTotal();
    };

    qtyInput.oninput = () => {
        qty = parseInt(qtyInput.value) || 1;
        if (qty < 1) qty = 1;
        qtyInput.value = qty;
        updateTotal();
    };

    btnAddCart.onclick = () => {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(i => i.name === mauDangChon.name);

        if (existing) {
            existing.qty += qty;
        } else {
            cart.push({
                name: mauDangChon.name,
                price: product.price,
                img: mauDangChon.img,
                qty: qty
            });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert("🐼 Sản phẩm đã được thêm vào giỏ hàng!");
    };

    // Khởi tạo giao diện
    renderMauSac();
    updateTotal();

</script>
